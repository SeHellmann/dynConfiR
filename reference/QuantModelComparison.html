<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Quantitative Model Comparison — QuantModelComparison • dynConfiR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantitative Model Comparison — QuantModelComparison"><meta name="description" content="subject_modelweights computes the model weights (as probabilities) of
individual subjects based on an information criterion (BIC, AIC, or AICc).
group_BMS performs a Bayesian model comparison based on marginal
likelihoods (alias model evidence), given for different models across different
subject on a group level using a fixed effects model and a random effects model
on the distribution of model probabilities (see Rigoux et al., 2014 and Details section).
group_BMS_fits is a wrapper for group_BMS that can be used with the
output of fitRTConfModels, i.e. a data frame with information
criteria for different models and subjects, using a information criterion to
approximate the model evidence."><meta property="og:description" content="subject_modelweights computes the model weights (as probabilities) of
individual subjects based on an information criterion (BIC, AIC, or AICc).
group_BMS performs a Bayesian model comparison based on marginal
likelihoods (alias model evidence), given for different models across different
subject on a group level using a fixed effects model and a random effects model
on the distribution of model probabilities (see Rigoux et al., 2014 and Details section).
group_BMS_fits is a wrapper for group_BMS that can be used with the
output of fitRTConfModels, i.e. a data frame with information
criteria for different models and subjects, using a information criterion to
approximate the model evidence."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dynConfiR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dynConfiR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ModellingWorkflow.html">Illustration of the workflow for a modelling study using dynConfiR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SeHellmann/dynConfiR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quantitative Model Comparison</h1>
      <small class="dont-index">Source: <a href="https://github.com/SeHellmann/dynConfiR/blob/main/R/QuantitativeAnalysis.R" class="external-link"><code>R/QuantitativeAnalysis.R</code></a></small>
      <div class="d-none name"><code>QuantModelComparison.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>subject_modelweights</code> computes the model weights (as probabilities) of
individual subjects based on an information criterion (BIC, AIC, or AICc).
<code>group_BMS</code> performs a Bayesian model comparison based on marginal
likelihoods (alias model evidence), given for different models across different
subject on a group level using a fixed effects model and a random effects model
on the distribution of model probabilities (see Rigoux et al., 2014 and Details section).
<code>group_BMS_fits</code> is a wrapper for <code>group_BMS</code> that can be used with the
output of <code><a href="fitRTConfModels.html">fitRTConfModels</a></code>, i.e. a data frame with information
criteria for different models and subjects, using a information criterion to
approximate the model evidence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">subject_modelweights</span><span class="op">(</span><span class="va">fits</span>, measure <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">group_BMS_fits</span><span class="op">(</span><span class="va">fits</span>, measure <span class="op">=</span> <span class="st">"BIC"</span>, opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, alpha0 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">group_BMS</span><span class="op">(</span><span class="va">mlp</span>, opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, alpha0 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fits">fits<a class="anchor" aria-label="anchor" href="#arg-fits"></a></dt>
<dd><p>a data frame as returned by <code><a href="fitRTConfModels.html">fitRTConfModels</a></code>.
Should contain a column <code>model</code>indicating the model name, a column
<code>subject</code> (alternatively <code>sbj</code> or <code>participant</code>) indicating the grouping
structure of the data, and a column with the name given by the <code>measure</code>
argument containing the values of the information criterion that should be
used to approximate model evidence.</p></dd>


<dt id="arg-measure">measure<a class="anchor" aria-label="anchor" href="#arg-measure"></a></dt>
<dd><p>the name of the column indicating the information criterion
to approximate model evidence. For outputs of <code><a href="fitRTConfModels.html">fitRTConfModels</a></code>,
the available measures are 'BIC', 'AIC', and 'AICc'. Any other approximation
for the model evidence may be used, the measure is transferred to log model
evidence by taking -measure/2.</p></dd>


<dt id="arg-opts">opts<a class="anchor" aria-label="anchor" href="#arg-opts"></a></dt>
<dd><p>a list with options for the iteration algorithm to estimate
the parameter of the Dirichlet distribution. Following values may be provided:</p><ul><li><p><code>maxiter</code> the maximum number of iterations (Default: 200)</p></li>
<li><p><code>tol</code> the tolerance for changes in the free energy approximation
to stop the algorithm, if abs(FE(i+1)-FE(i))&lt;tol the algorithm
is stopped (Default: 1e-4)</p></li>
<li><p><code>eps</code> The number to substitute values of 0 in calls to log (Default: 1e-32)</p></li>
</ul></dd>


<dt id="arg-alpha-">alpha0<a class="anchor" aria-label="anchor" href="#arg-alpha-"></a></dt>
<dd><p>a positive numeric vector representing the parameter of a
Dirichlet distribution used as prior over model probabilities. The length should
be equal to <code>nrow(mlp)</code> for <code>group_BMS</code>, and equal to the number of unique names
in the <code>model</code> column of <code>fits</code> for <code>group_BMS_fits</code>.</p></dd>


<dt id="arg-mlp">mlp<a class="anchor" aria-label="anchor" href="#arg-mlp"></a></dt>
<dd><p>a matrix containing the logarithm of marginal probabilities
(i.e. log model evidence) with N columns representing individuals (or any
other grouping structure) and K rows representing the models.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>subject_modelweights</code> returns a data frame of subject-wise
model probabilities with rows for each subject and columns for the models
given by name and one column for the subject ID as given in the input.
<code>group_BMS</code> and <code>group_BMS_fits</code> return a list with two entries:</p><ul><li><p><code>model_weights</code>: a matrix with rows for each model (row names indicate the
model names for <code>group_BMS_fits</code> and for <code>group_BMS</code> if
row names are available in <code>mlp</code>), and following columns:
<code>alpha</code> (the alpha parameter of the Dirichlet posterior
over model probabilities in the population), <code>r</code> (the
mean probabilities of each model in the population), <code>ep</code>
and <code>pep</code> (exceedance and protected exceedance
probabilities for each model), and <code>fx_prob</code> (the
posterior model probabilities if a fixed true model is
assumed in the population).</p></li>
<li><p><code>summary_stats</code>: a vector giving statistics for the Bayesian model comparison
that may be used for other analyses:
Bayesian omnibus risks: <code>bor</code> (random effects model against the
null model), <code>bor_fixed</code> (fixed effects model against the
null model), and <code>bor_re_fixed</code> (random effects model
against the fixed effects model) (higher values indicating a
simpler model), and
estimations of the Free Energy of the Dirichlet
distribution <code>FE</code> (random effects model), <code>FE0</code> (null model),
and <code>FEfixed</code> (fixed effects model)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This set of function can be used for model comparisons on a group
level when the models were not fitted hierarchical but by fitting the models
independently to different subgroups (e.g. data from different subjects).</p>
<p>The function <code>subject_modelweights</code> computes the model weights for each subject
separately to inspect predominant models but also heterogeneity within the
population.
The functions <code>group_BMS</code> and <code>group_BMS_fits</code> can be used for a Bayesian
model selection on the group level following the approach of Rigoux et al.
(2014).
The approach compares three different models for the generative structure of
the data and gives estimates for model probabilities for the fixed and random
effects models.
The <strong>fixed effects model</strong> assumes that there is a single model that
generated the data of all subjects. Thus, model weights may be computed directly
by multiplying the model weights computed on a subject-level. This model is
formulated in a Bayesian way using a Multinomial distribution over the models
as prior with some prior parameter alpha0 giving the prior model weights.
This is updated according to the marginal model likelihoods resulting in a
single poterior vector of model probabilities, reported in the column
<code>fx_prob</code> of the <code>model_weights</code> data frame.
The random effects model assumes that there is a vector of model probabilities
and each subject may generated by a different model, each drawn from a Multinomial
distribution. The Bayesian prior on this vector of model probabilities is
given by a Dirichlet distribution with some parameter alpha0. The function
uses a variational technique to approximate the alpha parameter of the
posterior Dirichlet distribution. Within this framework several statistics
may be used for model selection. The <code>model_weights</code> data frame reports the
posterior <code>alpha</code> parameter, as well as the posterior mean <code>r</code> of the corresponding
dirichlet distribution. The exceedance probability <code>ep</code> represents the probability
that given a random sample from the Dirichlet distribution the probability
of the model is greater than all other probailities. Finally, the
protected exceedance probability (<code>pep</code>) is a scaled version of the <code>ep</code>
multiplying the <code>ep</code> by one minus the Bayesian omnibus risk (BOR). The Bayesian omnibus
risk is the posterior probability of the  <strong>null model</strong> against the random
effects model. The <strong>null model</strong> assumes that all models are generating the
subjects' data with equal probability and results from taking the limit of
alpha0 towards infinity. The Bayesian omnibus risk is reported in the <code>summary_stats</code>
together with the free energy approximation of the null, the fixed effects,
and the random effects models.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rigoux, L., Stephan, K. E., Friston, K. J., &amp; Daunizeau, J. (2014).
Bayesian model selection for group studies - revisited. <em>NeuroImage</em>,
84, 971–985. doi: 10.1016/j.neuroimage.2013.08.065</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Hellmann.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Define a data frame with information criteria from model fits</span></span></span>
<span class="r-in"><span><span class="co"># (this is a sub-data.frame from an output of fitRTConfModels with</span></span></span>
<span class="r-in"><span><span class="co"># 8 subjects, three models and rounded information criteria)</span></span></span>
<span class="r-in"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  participant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dynaViTE"</span>, <span class="st">"2DSD"</span>, <span class="st">"PCRMt"</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5318</span>, <span class="fl">5665</span>, <span class="fl">1659</span>, <span class="fl">3856</span>, <span class="fl">5508</span>, <span class="fl">3982</span>, <span class="fl">3950</span>, <span class="fl">3998</span>,</span></span>
<span class="r-in"><span>          <span class="fl">4114</span>, <span class="fl">4216</span>, <span class="fl">4314</span>, <span class="fl">4419</span>, <span class="fl">3170</span>, <span class="fl">3489</span>, <span class="fl">3256</span>, <span class="fl">1950</span>,</span></span>
<span class="r-in"><span>          <span class="fl">1934</span>, <span class="fl">2051</span>, <span class="fl">3194</span>, <span class="fl">3317</span>, <span class="fl">3359</span>, <span class="fl">9656</span>, <span class="fl">10161</span>, <span class="fl">4024</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5211</span>, <span class="fl">5577</span>, <span class="fl">1577</span>, <span class="fl">3750</span>, <span class="fl">5420</span>, <span class="fl">3899</span>, <span class="fl">3843</span>, <span class="fl">3911</span>,</span></span>
<span class="r-in"><span>          <span class="fl">4031</span>, <span class="fl">4109</span>, <span class="fl">4226</span>, <span class="fl">4337</span>, <span class="fl">3063</span>, <span class="fl">3401</span>, <span class="fl">3173</span>, <span class="fl">1844</span>,</span></span>
<span class="r-in"><span>          <span class="fl">1847</span>, <span class="fl">1969</span>, <span class="fl">3087</span>, <span class="fl">3229</span>, <span class="fl">3277</span>, <span class="fl">9549</span>, <span class="fl">10074</span>, <span class="fl">3942</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  AICc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5212</span>, <span class="fl">5578</span>, <span class="fl">1577</span>, <span class="fl">3751</span>, <span class="fl">5421</span>, <span class="fl">3900</span>, <span class="fl">3844</span>, <span class="fl">3911</span>,</span></span>
<span class="r-in"><span>           <span class="fl">4032</span>, <span class="fl">4110</span>, <span class="fl">4227</span>, <span class="fl">4337</span>, <span class="fl">3064</span>, <span class="fl">3402</span>, <span class="fl">3174</span>, <span class="fl">1845</span>,</span></span>
<span class="r-in"><span>           <span class="fl">1848</span>, <span class="fl">1970</span>, <span class="fl">3088</span>, <span class="fl">3230</span>, <span class="fl">3277</span>, <span class="fl">9550</span>, <span class="fl">10074</span>, <span class="fl">3942</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Compute subject-wise model probabitilities based on different ICs</span></span></span>
<span class="r-in"><span><span class="fu">subject_modelweights</span><span class="op">(</span><span class="va">fits</span>, measure <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           2DSD        PCRMt     dynaViTE participant</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.000000e+00 1.000000e+00 0.0000000000           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.000000e+00 4.359610e-28 1.0000000000           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3.775135e-11 2.442601e-36 1.0000000000           3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 5.242886e-22 8.300611e-45 1.0000000000           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 5.370691e-70 2.115131e-19 1.0000000000           5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 9.996646e-01 3.923080e-26 0.0003353501           6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 1.953842e-27 1.481512e-36 1.0000000000           7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 0.000000e+00 1.000000e+00 0.0000000000           8</span>
<span class="r-in"><span><span class="fu">subject_modelweights</span><span class="op">(</span><span class="va">fits</span>, measure <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           2DSD        PCRMt  dynaViTE participant</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.000000e+00 1.000000e+00 0.0000000           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.000000e+00 4.416326e-33 1.0000000           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.713908e-15 1.500786e-41 1.0000000           3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.924396e-26 3.093350e-50 1.0000000           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 4.020060e-74 1.299581e-24 1.0000000           5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.824255e-01 5.876547e-28 0.8175745           6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 1.462486e-31 5.521082e-42 1.0000000           7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 0.000000e+00 1.000000e+00 0.0000000           8</span>
<span class="r-in"><span><span class="fu">subject_modelweights</span><span class="op">(</span><span class="va">fits</span>, measure <span class="op">=</span> <span class="st">"AICc"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           2DSD        PCRMt  dynaViTE participant</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.000000e+00 1.000000e+00 0.0000000           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.000000e+00 4.416326e-33 1.0000000           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.825757e-15 1.500786e-41 1.0000000           3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.924396e-26 5.100072e-50 1.0000000           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 4.020060e-74 1.299581e-24 1.0000000           5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.824255e-01 5.876547e-28 0.8175745           6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 1.462486e-31 9.102726e-42 1.0000000           7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 0.000000e+00 1.000000e+00 0.0000000           8</span>
<span class="r-in"><span><span class="co"># Conduct group-level Bayesian model selection based on BIC</span></span></span>
<span class="r-in"><span><span class="fu">group_BMS_fits</span><span class="op">(</span><span class="va">fits</span>, measure<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model_weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            alpha         r     ep       pep fx_prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2DSD     1.99879 0.1817082 0.0476 0.2005117       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCRMt    3.00000 0.2727273 0.1377 0.2423942       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dynaViTE 6.00121 0.5455646 0.8147 0.5570941       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            bor             FE            FE0        FEfixed      bor_fixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5.351552e-01  -1.301043e+04  -1.301029e+04  -1.343310e+04   1.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bor_re_fixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.735901e-184 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## General group-level Bayesian model selection based on any marginal log-probabilities</span></span></span>
<span class="r-in"><span><span class="co"># Compute marginal log-likelihood based on BIC from fits</span></span></span>
<span class="r-in"><span><span class="va">mlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, ncol<span class="op">=</span><span class="fl">8</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="va">mlp</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fits</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"BIC"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mlp</span> <span class="op">&lt;-</span> <span class="op">-</span> <span class="va">mlp</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mlp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dynaViTE"</span>, <span class="st">"2DSD"</span>, <span class="st">"PCRMt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># conduct group BMS:</span></span></span>
<span class="r-in"><span><span class="fu">group_BMS</span><span class="op">(</span><span class="va">mlp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model_weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            alpha         r     ep       pep fx_prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dynaViTE 6.00121 0.5455646 0.8204 0.5597438       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2DSD     1.99879 0.1817082 0.0486 0.2009765       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCRMt    3.00000 0.2727273 0.1310 0.2392797       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            bor             FE            FE0        FEfixed      bor_fixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5.351552e-01  -1.301043e+04  -1.301029e+04  -1.343310e+04   1.000000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bor_re_fixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.735901e-184 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Hellmann, Manuel Rausch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

