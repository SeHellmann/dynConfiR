<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Log-Likelihood functions for the dynWEV and 2DSD models of confidence — LogLikWEV • dynConfiR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Log-Likelihood functions for the dynWEV and 2DSD models of confidence — LogLikWEV"><meta name="description" content="Computes the Log-likelihood for given data and parameters in the
dynWEV model (Hellmann et al., 2023) and the 2DSD model
(Pleskac &amp;amp; Busemeyer, 2010). It is a wrapped version of the
respective densities ddynaViTE and d2DSD,
where one can find more information about the parameters
(z is always given relatively, in the likelihood).
The function is mainly used in fitRTConf but
exported for individual usage in other contexts."><meta property="og:description" content="Computes the Log-likelihood for given data and parameters in the
dynWEV model (Hellmann et al., 2023) and the 2DSD model
(Pleskac &amp;amp; Busemeyer, 2010). It is a wrapped version of the
respective densities ddynaViTE and d2DSD,
where one can find more information about the parameters
(z is always given relatively, in the likelihood).
The function is mainly used in fitRTConf but
exported for individual usage in other contexts."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dynConfiR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dynConfiR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ModellingWorkflow.html">Illustration of the workflow for a modelling study using dynConfiR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SeHellmann/dynConfiR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Log-Likelihood functions for the dynWEV and 2DSD models of confidence</h1>
      <small class="dont-index">Source: <a href="https://github.com/SeHellmann/dynConfiR/blob/main/R/likelihoods_WEV.R" class="external-link"><code>R/likelihoods_WEV.R</code></a></small>
      <div class="d-none name"><code>LogLikWEV.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the Log-likelihood for given data and parameters in the
dynWEV model (Hellmann et al., 2023) and the 2DSD model
(Pleskac &amp; Busemeyer, 2010). It is a wrapped version of the
respective densities <code><a href="dynaViTE.html">ddynaViTE</a></code> and <code><a href="d2DSD.html">d2DSD</a></code>,
where one can find more information about the parameters
(<code>z</code> is always given relatively, in the likelihood).
The function is mainly used in <code><a href="fitRTConf.html">fitRTConf</a></code> but
exported for individual usage in other contexts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">LogLikWEV</span><span class="op">(</span><span class="va">data</span>, <span class="va">paramDf</span>, model <span class="op">=</span> <span class="st">"dynaViTE"</span>, simult_conf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  precision <span class="op">=</span> <span class="fl">6</span>, stop_on_error <span class="op">=</span> <span class="cn">TRUE</span>, data_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a dataframe where each row is one trial. Containing following variables:</p><ul><li><p>condition    (not necessary; convertible to integer (e.g. factor); for different levels of stimulus quality),</p></li>
<li><p>rating       (convertible to integer (e.g. factor); discrete confidence judgments),</p></li>
<li><p>rt           (numeric; giving reaction times for decision task),</p></li>
<li><p>stimulus     (values at least convertible to c(-1,1); stimulus category (direction of evidence accumulation))</p></li>
<li><p>response     (characters in <code>"upper"</code>, <code>"lower"</code> (or convertible to); direction of decision; correct answers are "lower" for stimulus=-1; and "upper" for stimulus=1),</p></li>
</ul></dd>


<dt id="arg-paramdf">paramDf<a class="anchor" aria-label="anchor" href="#arg-paramdf"></a></dt>
<dd><p>list or data.frame with one row. Names should match the names of
<a href="dynaViTE.html">dynaViTE</a> and <a href="d2DSD.html">2DSD</a> model specific parameter names. For different
stimulus quality/mean drift rates, names should be <code>v1</code>, <code>v2</code>, <code>v3</code>,....
Different <code>sv</code> and/or <code>s</code> parameters are possible with <code>sv1</code>, <code>sv2</code>, <code>sv3</code>... (<code>s1</code>, <code>s2</code>, <code>s3</code>,...
respectively) with equally many steps as for drift rates. Additionally, the confidence
thresholds should be given by names with <code>thetaUpper1</code>, <code>thetaUpper2</code>,..., <code>thetaLower1</code>,... or,
for symmetric thresholds only by <code>theta1</code>, <code>theta2</code>,...
(see Details for the correspondence to the data)</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>character scalar. One of "dynWEV" or "2DSD" for the model to fit.</p></dd>


<dt id="arg-simult-conf">simult_conf<a class="anchor" aria-label="anchor" href="#arg-simult-conf"></a></dt>
<dd><p>logical. Whether in the experiment confidence was reported simultaneously
with the decision, as then decision and confidence judgment are assumed to have happened
subsequent before response and computations are different, when there is an observable
interjudgment time (then <code>simult_conf</code> should be <code>FALSE</code>).</p></dd>


<dt id="arg-precision">precision<a class="anchor" aria-label="anchor" href="#arg-precision"></a></dt>
<dd><p>numerical scalar. Precision of calculation for integration over z and t0.</p></dd>


<dt id="arg-stop-on-error">stop_on_error<a class="anchor" aria-label="anchor" href="#arg-stop-on-error"></a></dt>
<dd><p>logical. If TRUE an error in the function will be returned in case of
invalid parameters. Otherwise, the output will be 0 without error.</p></dd>


<dt id="arg-data-names">data_names<a class="anchor" aria-label="anchor" href="#arg-data-names"></a></dt>
<dd><p>list. Possibility of giving alternative column names for the variables
in the data. By default column names are identical to the
ones given in the data argument description.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Possibility of giving alternative variable names in data frame
(in the form <code>condition = "SOA"</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric scalar. The summed Log-likelihood of the data given the parameters in the respective model. If one or more row-wise probabilities is &lt;=0,
the function returns -1e+12.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note, that the requirements on the format of the columns for the likelihood functions
are much stricter, than in <code><a href="fitRTConf.html">fitRTConf</a></code>.
This is because the function is very frequently calls in the optimization routines of the
fitting process and the preprocessing steps are
therefore included in that function.</p>
<p><strong>rating, condition</strong>. If integer, values should range from 1 to number of possible
ratings/conditions. If a factor, the number of levels should be
equal to number of possible ratings/conditions. This should be consistent with the
parameter vector. The confidence thresholds should be named
as <code>thetaUpper1</code>, <code>thetaLower1</code>,.... (or <code>theta1</code>,... for symmetric thresholds), with the
number of ratings -1 and the mean drift rates (and possibly the
standard deviation in drift rates) should be denoted as <code>v1</code>, <code>v2</code>,...
(and <code>sv1</code>, <code>sv2</code>,.../<code>s1</code>, <code>s2</code>, ...) with the number equal to the number of conditions.
If only one condition is used <code>v</code> will be accepted as well as <code>v1</code>.</p>
<p><strong>stimulus, response</strong>. stimulus should always be given in numerical format with values -1 and 1.
response should always be given as a character vector with <code>"lower"</code> and <code>"upper"</code> as values.
This corresponds to the situation of Ratcliff's diffusion model (Ratcliff, 1978), where stimulus is the sign of the mean drift direction and
the response is the <code>"upper"</code> or <code>"lower"</code> boundary that is first hit by the evidence accumulation. A correct decision is therefore <code>"lower"</code>,
if stimulus is -1, and <code>"upper"</code>, if stimulus is 1.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hellmann, S., Zehetleitner, M., &amp; Rausch, M. (2023). Simultaneous modeling of choice, confidence and response time in visual perception. <em>Psychological Review</em> 2023 Mar 13. doi: 10.1037/rev0000411. Epub ahead of print. PMID: 36913292.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Hellmann.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># 1. Generate data from an artificial participants</span></span></span>
<span class="r-in"><span><span class="co"># Get random drift direction (i.e. stimulus category) and</span></span></span>
<span class="r-in"><span><span class="co"># stimulus discriminability (two steps: hard, easy)</span></span></span>
<span class="r-in"><span><span class="va">stimulus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">200</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">discriminability</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">200</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># generate data for participant 1</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="dynaViTE.html">rdynaViTE</a></span><span class="op">(</span><span class="fl">200</span>, a<span class="op">=</span><span class="fl">2</span>,v<span class="op">=</span><span class="va">stimulus</span><span class="op">*</span><span class="va">discriminability</span><span class="op">*</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>             t0<span class="op">=</span><span class="fl">0.2</span>,z<span class="op">=</span><span class="fl">0.5</span>, sz<span class="op">=</span><span class="fl">0.1</span>,sv<span class="op">=</span><span class="fl">0.1</span>, st0<span class="op">=</span><span class="fl">0</span>,  tau<span class="op">=</span><span class="fl">4</span>, s<span class="op">=</span><span class="fl">1</span>, w<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># discretize confidence ratings (only 2 steps: unsure vs. sure)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">rating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">conf</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1</span>, <span class="cn">Inf</span><span class="op">)</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">stimulus</span> <span class="op">&lt;-</span> <span class="va">stimulus</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">discriminability</span> <span class="op">&lt;-</span> <span class="va">discriminability</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">response</span><span class="op">!=</span><span class="fl">0</span>, <span class="op">]</span> <span class="co"># drop not finished decision processes</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span> <span class="co"># drop conf measure (unobservable variable)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rt response rating stimulus discriminability</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.48        1      2       -1                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.00        1      2        1                2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.29       -1      2       -1                2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.51        1      2        1                2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.99        1      2        1                2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.54       -1      1        1                1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. Define some parameter set in a data.frame</span></span></span>
<span class="r-in"><span><span class="va">paramDf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">2.5</span>,v1<span class="op">=</span><span class="fl">0.5</span>, v2<span class="op">=</span><span class="fl">1</span>, t0<span class="op">=</span><span class="fl">0.1</span>,z<span class="op">=</span><span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>                      sz<span class="op">=</span><span class="fl">0</span>,sv<span class="op">=</span><span class="fl">0.2</span>, st0<span class="op">=</span><span class="fl">0</span>,  tau<span class="op">=</span><span class="fl">3</span>, w<span class="op">=</span><span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>                      theta1<span class="op">=</span><span class="fl">0.8</span>, svis<span class="op">=</span><span class="fl">0.5</span>, sigvis<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3. Compute log likelihood for parameter and data</span></span></span>
<span class="r-in"><span><span class="fu">LogLikWEV</span><span class="op">(</span><span class="va">data</span>, <span class="va">paramDf</span>, model<span class="op">=</span><span class="st">"dynWEV"</span>, condition<span class="op">=</span><span class="st">"discriminability"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -390.9572</span>
<span class="r-in"><span><span class="co"># adding the hypothetical interjudgment time to response times</span></span></span>
<span class="r-in"><span><span class="co"># results in the same log likelihood as before when simult_conf=TRUE</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">rt</span> <span class="op">+</span> <span class="va">paramDf</span><span class="op">$</span><span class="va">tau</span></span></span>
<span class="r-in"><span><span class="fu">LogLikWEV</span><span class="op">(</span><span class="va">data</span>, <span class="va">paramDf</span>, model<span class="op">=</span><span class="st">"dynWEV"</span>, condition<span class="op">=</span><span class="st">"discriminability"</span>, simult_conf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -390.9572</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the same function for "2DSD" model</span></span></span>
<span class="r-in"><span><span class="va">paramDf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">2.5</span>,v1<span class="op">=</span><span class="fl">0.5</span>, v2<span class="op">=</span><span class="fl">1</span>, t0<span class="op">=</span><span class="fl">0.1</span>,z<span class="op">=</span><span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>                      sz<span class="op">=</span><span class="fl">0</span>,sv<span class="op">=</span><span class="fl">0.2</span>, st0<span class="op">=</span><span class="fl">0</span>,  tau<span class="op">=</span><span class="fl">3</span>, theta1<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">LogLikWEV</span><span class="op">(</span><span class="va">data</span>, <span class="va">paramDf</span>, model<span class="op">=</span><span class="st">"2DSD"</span>, condition<span class="op">=</span><span class="st">"discriminability"</span>, simult_conf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -414.9727</span>
<span class="r-in"><span><span class="co"># this results in the same log likelihood as before</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Hellmann, Manuel Rausch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

